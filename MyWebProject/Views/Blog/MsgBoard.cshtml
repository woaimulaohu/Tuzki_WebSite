@{
    int postId = 0;
    string boardName = string.Empty;
    int.TryParse(Model.ToString(), out postId);
    boardName = postId == 0 ? "留言板" : "评论";
}
<style>
    .row {
        margin-left: 0;
        margin-right: 0;
    }
</style>
<!--此文章留言区-->
<div class="row">
    <h2 style="text-align:right;vertical-align:top;margin-top:0;">@boardName</h2>
</div>
<div class="row" id="boardContent">

</div>
<div class="row" style="text-align:right;margin-right:5px;">
    <ul class="pagination pagination-sm" id="boardPage"></ul>
</div>
<input id="lastReplyId" style="visibility:collapse" value="">
<div class="row">
    <form role="form" id="boardForm" style="margin-bottom:10px">
        <div class="form-group">
            <input type="text" class="form-control" id="nickName" placeholder="你的昵称">
        </div>
        <div class="form-group">
            <textarea class="form-control" id="comment" placeholder="我有话说"></textarea>
        </div>
        <input id="avatarUrl" style="display:none" />
        <button type="button" class="btn btn-info" onclick="leaveComment('@postId','0')">说完了</button>
    </form>
</div>
<script>
   window.onload= function BoardBindUserInfo() {
        $("#avatarUrl").val(getAvatar());
        $("#nickName").val(getUserName());
        $("#nickName").attr("placeholder", getUserName());
    }
    function leaveComment(postId, beforCommentsId) {
        if ($('#nickName').val().length > 30) {
            tips('boardForm', "昵称过长", 'info');
            setTimeout("$('#tips').remove()", 5000);
            return;
        }
        if ($('#nickName').val().length == 0) {
            tips('boardForm', "不想给自己来个炫酷的昵称么", 'info');
            setTimeout("$('#tips').remove()", 5000);
            return;
        }
        if ($('#comment').val().length == 0) {
            tips('boardForm', "不想说点什么么", 'info');
            setTimeout("$('#tips').remove()", 5000);
            return;
        }
        $('#tips').remove();
        $.post('Blog/leaveComment', {
            'avatarUrl': $('#avatarUrl').val(),
            'nickName': $('#nickName').val(),
            'comment': $('#comment').val(),
            'beforCommentsId': beforCommentsId,
            'postId': postId,
        }, function (data) {
            getBoard('', '', postId);
            tips('boardForm', "感谢你的留言", 'success');
            setTimeout("$('#tips').remove()", 5000);
            $('#comment').val('')
        });
    }
    //更新留言板
    function getBoard(pageStartNum, pageSize, postId, isUpdataPage) {
        if (isNullOrEmpty(pageStartNum) || pageStartNum < 1) {
            pageStartNum = 1;
        }
        if (isNullOrEmpty(pageSize)) {
            pageSize = 5;
        }
        $.post('Blog/MsgBoardContent', {
            'pageStartNum': pageStartNum,
            'pageSize': pageSize,
            'postId': postId
        }, function (data) {
            $("#boardContent").html(data);
            if (isUpdataPage == 1) {
                getBoardPaging(pageStartNum, pageSize, postId);
            }
            $("#boardPage li").each(function () {
                $(this).attr("class", "");
                if ($(this).text() == pageStartNum) {
                    $(this).attr("class", "active");
                }
            });
        });
    }
    //获取页码
    function getBoardPaging(pageStartNum, pageSize, postId) {
        if (isNullOrEmpty(pageStartNum) || pageStartNum < 1) {
            pageStartNum = 1;
        }
        if (isNullOrEmpty(pageSize)) {
            pageSize = 5;
        }
        var pageEndNum = pageSize + pageStartNum;
        //生成当前页码
        var startBack = parseInt(pageStartNum) - parseInt(pageSize) < 0 ? 1 : parseInt(pageStartNum) - parseInt(pageSize);
        var html = '<li><a href="javascript:void(0)" onclick="getBoard(' + parseInt(startBack) + ',' + parseInt(pageSize) + ',' + postId + ',' + 1 + ')"><<</a></li>';
        for (var i = pageStartNum; i < pageEndNum; i++) {
            if (i == pageStartNum) {
                html += '<li class="active"><a href="javascript:void(0)" onclick="getBoard(' + i + ',' + parseInt(pageSize) + ',' + postId + ',' + 0 + ')">' + i + '</a></li>';
            } else {
                html += '<li><a href="javascript:void(0)" onclick="getBoard(' + i + ',' + parseInt(pageSize) + ',' + postId + ',' + 0 + ')">' + i + '</a></li>';
            }
        }
        var startForward = parseInt(pageStartNum) + parseInt(pageSize);
        html += '<li><a href="javascript:void(0)" onclick="getBoard(' + parseInt(startForward) + ',' + parseInt(pageSize) + ',' + postId + ',' + 1 + ')">>></a></li>';
        $('#boardPage').html(html);
    }
    getBoard('', '', '@postId', 1);
</script>
